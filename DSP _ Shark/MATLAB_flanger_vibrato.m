clear all;
close all;

Triangle=0;
Parabole=0;
Shell=0;
N=16000;
Ns=8000;

%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           Triangle                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Toff=0;
for i=1:N
    
if Toff==16000
    Toff=0;
end
if Toff<4001
    T   =  0   +   Toff            *   0.9/4000;
elseif Toff>12000
    T   = -0.9 +   (Toff-12000)    *   0.9/4000;
else
    T   =  0.9 -   (Toff-4000)     *   0.9/4000;
end
Triangle=[Triangle T];
Toff=Toff+1;
end;
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           Parabole                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Toff=0;
for i=1:N
    
if Toff==16000
    Toff=0;
end
if Toff<8001
    %T= 0.9-((Toff-4000)*sqrt(0.9)/4000)^2;                     % T = 0.8 -(T^2/4000^2 - 2T/4000 +1) 
    %T = -Toff*Toff*0.0000000625+Toff*0.0005;                   % T = 1 - T^2/4000^2 + 2T/4000 -1
    T = -Toff*0.00000005625;
    T = (T+0.00045)*Toff;
else
    %T = -0.9+((Toff-12000)*sqrt(0.9)/4000)^2;                  % T = -1 +((Toff/4000-3))^2
    %T =  Toff*Toff*0.00000005625-Toff*0.00135+8;                 % T = -1 + T^2/4000^2 -2T/4000 +3*3
    T = Toff*0.00000005625;
    T = (T-0.00135)*Toff+7.2;
end
Parabole=[Parabole T];
Toff=Toff+1;
end
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                 Vibrato - Shell                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Toff=0;
for i=1:Ns
    
if Toff==8000
    Toff=0;
end
if Toff<4001
    %T= 1-((Toff-2000)/2000)^2;                               % T = 1 -(T^2/2000^2 - 2T/2000 +1) 
    %T = -Toff*Toff*0.00000025+Toff*0.0001;                   % T = 1 - T^2/4000^2 + 2T/4000 -1
    T = -Toff*0.00000025;
    T = (T+0.001)*Toff;
else
    %T = -1+((Toff-6000)/2000)^2;                            % T = -1 +((Toff/2000-3))^2
    %T =  Toff*Toff*0.00000025-Toff*0.003+8;                 % T = -1 + T^2/2000^2 -2T/2000 +3*3
    T = Toff*0.00000025;
    T = (T-0.003)*Toff+8;
end
Shell=[Shell T];
Toff=Toff+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           Vibrato                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Gain=1.5
Vibrato=sin(2*pi*(80/48000)*(1:Ns)).*(Shell(2:Ns+1)+Gain)/(1+Gain);
figure;
plot(Vibrato)
title('Vibrato')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                             Plot                               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

figure;
hold on
plot(Parabole,'b')
plot(Triangle,'g')
hold off
title('Triangle Vert Parabole Bleu 3Hz')