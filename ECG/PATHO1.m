function [ malade1 ] = PATHO1(QRS_width_buff )

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%    I N I T I A L I S A T I O N    %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

N=length(QRS_width_buff);
seuil=zeros(1,N);
T=zeros(1,N);
H0=zeros(1,N);
s1=zeros(1,N);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%    V A R I A N C E     E C G     S A I N    %%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

s=zeros(1,ceil(N/3)-1);
for i=2:ceil(N/3)
    Longueur=QRS_width_buff(i);
    abscisse=0:ceil(Longueur/2)-1;
    s(i)=sqrt(1/(Longueur)*sum((abscisse-0).^2));
end
s0=mean(s);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%    N E Y M A N    P E A R S O N   %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for i=1:N
    Longueur=QRS_width_buff(i);
    abscisse=0:ceil(Longueur/2)-1;

    PFA=10^(-15);
    alpha=1-PFA;
    s1(i) =sqrt(1/Longueur*sum((abscisse-0).^2));
    seuil(i)=chi2inv(alpha,QRS_width_buff(i));
    T(i)=(1/s0)^2*QRS_width_buff(i)*s1(i)^2;

    if(T(i)-seuil(i)>0)
        H0(i)=1;
    else
        H0(i)=0;
    end    

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    T E S T    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

if mean(H0(ceil(N/2):end))>0.25
    malade1=1;
else
    malade1=0;
end

end

